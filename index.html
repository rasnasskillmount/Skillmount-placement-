<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Placement Predictor | Career Path</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root {
            --brand-blue: #00a8ff;
            --brand-blue-soft: #eef9ff;
            --pure-white: #ffffff;
            --text-main: #2d3436;
            --text-light: #636e72;
            --danger: #ff7675;
            --border-ui: #f1f2f6;
            --shadow-ux: 0 20px 40px rgba(0, 168, 255, 0.08);
        }

        * { box-sizing: border-box; }

        body { 
            font-family: 'Inter', sans-serif; 
            background: #f8fafc;
            margin: 0; padding: 20px;
            color: var(--text-main);
            display: flex; flex-direction: column; align-items: center;
        }

        .logo { text-align: center; margin: 20px 0; }
        .logo img { height: 150px; }

        .box { 
            max-width: 720px; width: 100%;
            background: var(--pure-white); 
            padding: 40px; 
            border-radius: 24px; 
            box-shadow: var(--shadow-ux);
            margin-bottom: 50px;
        }

        h2 { font-weight: 800; font-size: 1.8rem; letter-spacing: -1px; margin-bottom: 25px; text-align: center; color: var(--brand-blue); }

        
        #timerContainer {
            display: none;
            position: sticky;
            top: 10px;
            z-index: 1000;
            background: var(--brand-blue);
            color: white;
            padding: 10px 25px;
            border-radius: 50px;
            font-weight: 700;
            box-shadow: 0 10px 20px rgba(0, 168, 255, 0.2);
            margin-bottom: 20px;
            font-variant-numeric: tabular-nums;
        }

        .timer-warning { background: var(--danger) !important; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0.7; } }

       
        label { display: block; font-weight: 600; font-size: 0.85rem; margin-bottom: 8px; color: var(--text-light); }
        input, select { 
            width: 100%; padding: 16px; border-radius: 12px; 
            border: 2px solid var(--border-ui); background: #fcfcfc;
            font-size: 1rem; margin-bottom: 20px; outline: none;
        }
        input:focus { border-color: var(--brand-blue); background: #fff; }

        .btn-primary { 
            background: var(--brand-blue); color: white; border: none;
            padding: 18px; border-radius: 14px; font-weight: 700; width: 100%;
            cursor: pointer; transition: 0.3s; font-size: 1rem;
        }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0, 168, 255, 0.3); }

       
        .question-card {
            background: #fff; border: 2px solid var(--border-ui);
            padding: 25px; border-radius: 18px; margin-bottom: 20px;
        }
        .option-pill {
            display: flex; align-items: center; padding: 14px;
            margin-top: 10px; border-radius: 12px; border: 1px solid var(--border-ui);
            cursor: pointer; transition: 0.2s;
        }
        .option-pill:hover { background: var(--brand-blue-soft); }
        .option-pill input { margin-right: 15px; width: auto; margin-bottom: 0; }
        
       
        .result-display {
            padding: 25px; border-radius: 15px; text-align: center;
            font-weight: 700; font-size: 1.2rem; margin: 20px 0;
            display: none;
        }

        .admin-link { position: fixed; bottom: 20px; right: 20px; background: #fff; padding: 10px 20px; border-radius: 30px; text-decoration: none; color: var(--brand-blue); font-weight: 600; box-shadow: 0 4px 10px rgba(0,0,0,0.1); border: 1px solid var(--brand-blue-soft); }
    </style>
</head>
<body>

<div class="logo"><img src="Skillmount Blue.png" alt="Logo"></div>

<div id="timerContainer"><i class="fas fa-clock"></i> Time Left: <span id="timeLeft">05:00</span></div>

<div class="box" id="studentBox">
    <h2><i class="fas fa-user-graduate"></i> Skillmount Predictor</h2>
    <label>Full Name</label>
    <input type="text" id="studentName" placeholder="John Doe">
    <label>Phone Number</label>
    <input type="tel" id="studentPhone" placeholder="10-digit number">
    <button class="btn-primary" onclick="studentLogin()">Start Assessment</button>
</div>

<div class="box" id="testBox" style="display:none">
    <h2 id="welcome">Assessment</h2>
    <label>Select Course Path:</label>
    <select id="course" onchange="loadQuestions()">
        <option value="">-- Choose Your Stream --</option>
        <option value="bsc">BSc (Science/IT)</option>
        <option value="bcom">BCom (Finance)</option>
        <option value="bba">BBA (Management)</option>
        <option value="mba">MBA (Leadership)</option>
        <option value="ba">BA (Humanities)</option>
    </select>
    
    <div id="questions"></div>
    
    <button id="submitBtn" class="btn-primary" onclick="checkResult()" style="display:none">Submit Test</button>
    <div id="resultDiv" class="result-display"></div>
    <button id="pdfBtn" class="btn-primary" onclick="downloadPDF()" style="display:none; background: #2d3436; margin-top:10px;"><i class="fas fa-file-pdf"></i> Download Result</button>
    <button onclick="location.reload()" class="btn-primary" style="background:none; color:var(--text-light); font-size: 0.8rem;">Logout</button>
</div>

<div class="box" id="adminBox" style="display:none">
    <h2>Admin Access</h2>
    <input type="email" id="adminEmail" placeholder="Admin Email">
    <input type="password" id="adminPass" placeholder="Password">
    <button class="btn-primary" onclick="adminLogin()">Login to Dashboard</button>
    <button onclick="location.reload()" class="btn-primary" style="background:none; color:var(--text-light);">Back</button>
</div>

<a href="#" class="admin-link" onclick="showAdmin()">Admin Dashboard</a>

<script type="module">
   
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
    import { getFirestore, collection, addDoc, getDocs} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyAWS62gFaVKSUadKwcmVPFpEwKei5g8qGY",
        authDomain: "placement-predictor-skillmount.firebaseapp.com",
        projectId: "placement-predictor-skillmount",
        storageBucket: "placement-predictor-skillmount.firebasestorage.app",
        messagingSenderId: "1038162967890",
        appId: "1:1038162967890:web:f15be54b8401e5cea6ce8b"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

   
    let timerInterval;
    const TEST_DURATION = 5 * 60; 

    const questionBank = {
        bsc: [{q:"Average of 4 numbers is 20. Total?", options:["40","60","80","100"], answer:"80"}, {q:"Best skill for data roles?", options:["Memorization","Logical thinking","Handwriting","Reading"], answer:"Logical thinking"}],
        bcom: [{q:"Cost â‚¹500, Profit 20%. SP?", options:["550","600","650","700"], answer:"600"}, {q:"Who keeps financial records?", options:["HR","Marketing","Accountant","Sales"], answer:"Accountant"}],
        bba: [{q:"Sales increase depends on?", options:["Design","Customer needs","Rules","Uniform"], answer:"Customer needs"}, {q:"Manager skill?", options:["Silence","Communication","Luck","Force"], answer:"Communication"}],
        mba: [{q:"Demand up, supply same. Price?", options:["Down","Same","Up","Zero"], answer:"Up"}, {q:"Best KPI?", options:["Emails","Meetings","Revenue","Office"], answer:"Revenue"}],
        ba: [{q:"Best employability skill?", options:["Memorizing","Communication","Avoid teamwork","Only exams"], answer:"Communication"}, {q:"Career for good communication?", options:["Data entry","Content writing","Repair","Inventory"], answer:"Content writing"}]
    };

    window.studentLogin = function() {
        const name = document.getElementById("studentName").value.trim();
        const phone = document.getElementById("studentPhone").value.trim();
        if(!name || phone.length < 10) return alert("Please enter your name and valid phone.");
        
        localStorage.setItem("studentName", name);
        localStorage.setItem("studentPhone", phone);
        
        document.getElementById("studentBox").style.display = "none";
        document.getElementById("testBox").style.display = "block";
        document.getElementById("welcome").innerText = `Hello, ${name}`;
    }

    window.loadQuestions = function() {
        const course = document.getElementById("course").value;
        if(!course) return;
        
        const qDiv = document.getElementById("questions");
        qDiv.innerHTML = questionBank[course].map((item, i) => `
            <div class="question-card">
                <p><strong>Q${i+1}:</strong> ${item.q}</p>
                ${item.options.map(opt => `
                    <label class="option-pill">
                        <input type="radio" name="q${i}" value="${opt}"> ${opt}
                    </label>
                `).join('')}
            </div>
        `).join('');
        
        document.getElementById("submitBtn").style.display = "block";
        startTimer();
    }

    function startTimer() {
        if(timerInterval) clearInterval(timerInterval);
        let timeRemaining = TEST_DURATION;
        document.getElementById("timerContainer").style.display = "block";
        
        timerInterval = setInterval(() => {
            let mins = Math.floor(timeRemaining / 60);
            let secs = timeRemaining % 60;
            document.getElementById("timeLeft").innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            
            if(timeRemaining <= 60) document.getElementById("timerContainer").classList.add("timer-warning");
            
            if(timeRemaining <= 0) {
                clearInterval(timerInterval);
                alert("Time is up! Submitting your answers.");
                checkResult();
            }
            timeRemaining--;
        }, 1000);
    }

    window.checkResult = async function() {
        clearInterval(timerInterval);
        document.getElementById("timerContainer").style.display = "none";
        
        const course = document.getElementById("course").value;
        let score = 0;
        const total = questionBank[course].length;

        questionBank[course].forEach((q, i) => {
            const selected = document.querySelector(`input[name="q${i}"]:checked`);
            if(selected && selected.value === q.answer) score++;
        });

        const status = score === total ? "Placement Ready" : "Needs Training";
        const resultDiv = document.getElementById("resultDiv");
        resultDiv.style.display = "block";
        resultDiv.style.background = score === total ? "#e6fffa" : "#fff5f5";
        resultDiv.innerHTML = `Score: ${score}/${total} <br> ${status}`;
        
        document.getElementById("submitBtn").style.display = "none";
        document.getElementById("pdfBtn").style.display = "block";

        const data = {
            name: localStorage.getItem("studentName"),
            phone: localStorage.getItem("studentPhone"),
            course, score, status, date: new Date().toLocaleString()
        };
        
        localStorage.setItem("lastResult", JSON.stringify(data));
        await addDoc(collection(db, "students"), data);
    }

    window.downloadPDF = function() {
        const data = JSON.parse(localStorage.getItem("lastResult"));
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.text("Placement Assessment Result", 20, 20);
        doc.text(`Name: ${data.name}`, 20, 40);
        doc.text(`Score: ${data.score}`, 20, 50);
        doc.text(`Status: ${data.status}`, 20, 60);
        doc.save("Result.pdf");
    }

    window.showAdmin = () => {
        document.getElementById("studentBox").style.display = "none";
        document.getElementById("testBox").style.display = "none";
        document.getElementById("adminBox").style.display = "block";
    }

    window.adminLogin = async () => {
        const email = document.getElementById("adminEmail").value;
        const pass = document.getElementById("adminPass").value;
        try {
            await signInWithEmailAndPassword(auth, email, pass);
            alert("Admin functionality is ready (Console only in this view)");
        } catch(e) { alert("Login failed"); }
    }

</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</body>
</html>
